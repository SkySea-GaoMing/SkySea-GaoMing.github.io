<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Redis"><meta name="keywords" content="Java"><meta name="author" content="高明"><meta name="copyright" content="高明"><title>Redis | SkySea-GaoMing</title><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">1.</span> <span class="toc-text">参考</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NoSql概述"><span class="toc-number">2.</span> <span class="toc-text">NoSql概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NoSql特点"><span class="toc-number">2.1.</span> <span class="toc-text">NoSql特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NoSQL四大分类"><span class="toc-number">2.2.</span> <span class="toc-text">NoSQL四大分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis概述"><span class="toc-number">2.3.</span> <span class="toc-text">Redis概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux下载Redis"><span class="toc-number">2.4.</span> <span class="toc-text">Linux下载Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis配置"><span class="toc-number">2.4.1.</span> <span class="toc-text">Redis配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试性能"><span class="toc-number">2.5.</span> <span class="toc-text">测试性能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis"><span class="toc-number">3.</span> <span class="toc-text">Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基础知识"><span class="toc-number">3.1.</span> <span class="toc-text">基础知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#五大数据类型"><span class="toc-number">3.2.</span> <span class="toc-text">五大数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Redis-Key"><span class="toc-number">3.2.1.</span> <span class="toc-text">Redis-Key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#String"><span class="toc-number">3.2.2.</span> <span class="toc-text">String</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2762516417,1589137703&amp;fm=26&amp;gp=0.jpg"></div><div class="author-info__name text-center">高明</div><div class="author-info__description text-center">JAVA</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">42</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">10</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">6</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1605784321698&amp;di=835f40a2b6d3b20d5d4c32b6ae74423d&amp;imgtype=0&amp;src=http%3A%2F%2Ft9.baidu.com%2Fit%2Fu%3D390739009%2C2408580797%26fm%3D193)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">SkySea-GaoMing</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">Redis</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-29</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/">后端技术</a><span class="post-meta__separator">|</span><i class="fa fa-comment-o post-meta__icon" aria-hidden="true"></i><a href="/2020/02/29/Redis/#disqus_thread"><span class="disqus-comment-count" data-disqus-identifier="2020/02/29/Redis/"></span></a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>《Redis设计与实现》 遇见狂神说</p>
<h2 id="NoSql概述"><a href="#NoSql概述" class="headerlink" title="NoSql概述"></a>NoSql概述</h2><p>单机MySQL的年代 <img src="/2020/02/29/Redis/1.jpg" alt><br>Memcached(缓存)+Mysql+垂直拆分(读写分离) <img src="/2020/02/29/Redis/2.jpg" alt><br>分库分表+水平拆分+MySQL集群 <img src="/2020/02/29/Redis/3.jpg" alt><br>NoSQL not only sql不仅仅是数据库，泛指非关系型数据库。传统的关系型数据<br>库无法应对大数据，NoSQL在当今大数据时代发展瞬速。很多的数据类型比如用户<br>的个人信息、社交网络、地理位置等并不需要一个固定的格式，不需要多余的操作<br>就可以横向扩展</p>
<h3 id="NoSql特点"><a href="#NoSql特点" class="headerlink" title="NoSql特点"></a>NoSql特点</h3><ol>
<li>方便扩展，数据之间没有关系</li>
<li>大数据高性能（Redis一秒写8万，读取11万）缓存记录级、细粒度</li>
<li>数据类型是多样型的，不需要事先设计数据库，随取随用</li>
<li>不仅仅保存数据</li>
<li>没有固定的查询语言</li>
<li>键值对存储、列存储、文档存储、图形数据库</li>
<li>最终一致性</li>
<li>CAP定理和BASE</li>
<li>高性能、高可用、高可扩</li>
<li>关系型数据库特点</li>
</ol>
<ul>
<li>结构化组织</li>
<li>SQL</li>
<li>数据和关系都存储在单独的表中</li>
<li>有专门的数据操作以及数据定义语言</li>
<li>严格的一致性原则</li>
</ul>
<h3 id="NoSQL四大分类"><a href="#NoSQL四大分类" class="headerlink" title="NoSQL四大分类"></a>NoSQL四大分类</h3><p><img src="/2020/02/29/Redis/4.jpg" alt></p>
<ol>
<li>KV键值对</li>
</ol>
<ul>
<li>Redis</li>
</ul>
<ol start="2">
<li>文档型数据库 boson格式，和json一样</li>
</ol>
<ul>
<li>MongoDB 基于分布式文件存储的数据库，主要用来处理大量文档，是介于<br>关系型数据库和菲关系型数据库之间的产品</li>
<li>ConthDB</li>
</ul>
<ol start="3">
<li>列存储数据库</li>
</ol>
<ul>
<li>HBase</li>
<li>分布式文件系统</li>
</ul>
<ol start="4">
<li>图关系数据库</li>
</ol>
<ul>
<li>Neo4j</li>
<li>InfoGrid</li>
</ul>
<h3 id="Redis概述"><a href="#Redis概述" class="headerlink" title="Redis概述"></a>Redis概述</h3><p>Remote Dictionary Server，即远程字典服务</p>
<ol>
<li>内存存储，持久化(rdb aof)</li>
<li>效率高，可以用于高速缓存</li>
<li>发布订阅系统</li>
<li>地图信息分析</li>
<li>计时器</li>
</ol>
<h3 id="Linux下载Redis"><a href="#Linux下载Redis" class="headerlink" title="Linux下载Redis"></a>Linux下载Redis</h3><p>我在VMware虚拟机中创建centos，用xhell远程连接<br>如果有网络问题请参考 <a href="https://www.bbsmax.com/A/rV57Qk3jzP/" target="_blank" rel="noopener">https://www.bbsmax.com/A/rV57Qk3jzP/</a><br>下载Redis压缩文件，通过pscp从windows系统传送到Linux系统<br>注意最新的版本也就是6开头的话gcc的版本也要是最新的，这里我用了旧版本<br>pscp -r D:\shared\redis-5.0.10.tar.gz root@IP:/opt <img src="/2020/02/29/Redis/5.jpg" alt></p>
<h4 id="Redis配置"><a href="#Redis配置" class="headerlink" title="Redis配置"></a>Redis配置</h4><p>进入Redis-5.0.10可以查看所有文件，redis.conf是配置文件 <img src="/2020/02/29/Redis/6.jpg" alt><br>安装 yum install gcc-c++ ，Redis是用C++写的<br>安装完成后执行 make &amp; make install <img src="/2020/02/29/Redis/7.jpg" alt><br>Redis的默认安装路径在/usr/local/bin <img src="/2020/02/29/Redis/8.jpg" alt><br>cp /home/ming/redis-5.0.10/redis.conf kconfig 将配置文件复制一份<br>编辑redis.conf文件，将daemonize改为yes，默认后台启动<br>启动redis <img src="/2020/02/29/Redis/9.jpg" alt><br>关闭redis <img src="/2020/02/29/Redis/10.jpg" alt></p>
<h3 id="测试性能"><a href="#测试性能" class="headerlink" title="测试性能"></a>测试性能</h3><p>redis-benchmark是一个压力测试工具 <img src="/2020/02/29/Redis/11.jpg" alt><br>比如现在来测试100个并发连接和100000个请求<br>redis-benchmark -h localhost -p 6379 -c 100 -n 100000 <img src="/2020/02/29/Redis/12.jpg" alt><br>对100000个请求进行写入测试，一共有100个并发客户端，每次写入3个字节，<br>只有一台服务器处理这些请求，每秒能够处理51255.77个请求</p>
<h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><p>以上的所有操作都能完成后就可以正式学习Redis了</p>
<h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><p>Redis默认有16个数据库，可以查看redis.conf文件，默认使用的是第0个<br>数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select index #index就是指定使用哪个数据库</span><br><span class="line">dbsize #查看当前数据库的大小</span><br><span class="line">keys * #查看所有的key</span><br><span class="line">flushdb #清空数据库</span><br><span class="line">flushall #清空所有数据库</span><br></pre></td></tr></table></figure>
<p>Redis是单线程的，Redis是基于内存操作，CPU不是Redis的性能瓶颈，Redis<br>的瓶颈是根据机器内存和网络带宽，既然可以使用单线程就使用了呗。Redis是<br>用C语言写的，官方提供的数据为100000+的QPS，Redis有以下误区</p>
<ol>
<li>高性能服务器一定是多线程？</li>
<li>多线程一定比单线程效率高？</li>
</ol>
<p>Redis是将所有的数据全部放入内存中，所以使用单线程是最快的，因为多线程<br>会存在CPU上下文切换耗时</p>
<h3 id="五大数据类型"><a href="#五大数据类型" class="headerlink" title="五大数据类型"></a>五大数据类型</h3><p>通过官方介绍可以知道Redis可以用作数据库、缓存和消息中间件MQ。支持多种<br>类型的数据结构 string,hashes,lists,sets,sorted sets和范围查询，<br>bitmaps,hyperloglogs和地理空间索引半径查询 <img src="/2020/02/29/Redis/13.jpg" alt></p>
<h4 id="Redis-Key"><a href="#Redis-Key" class="headerlink" title="Redis-Key"></a>Redis-Key</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">exists key #如果存在key则返回1否则返回0</span><br><span class="line">move key 1 #将key移动到指定数据库</span><br><span class="line">del key #删除键</span><br><span class="line">expire key 10 #key在10s后过期</span><br><span class="line">ttl key #可以查看key还有几秒过期</span><br><span class="line">type key #查看类型</span><br></pre></td></tr></table></figure>
<h4 id="String"><a href="#String" class="headerlink" title="String"></a>String</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">append key &quot;xxx&quot; #添加字符串，key也可以不存在</span><br><span class="line">strlen key #获取字符串长度</span><br><span class="line">incr key #自动加1</span><br><span class="line">decr key #自动减1</span><br><span class="line">incrby key number #加number</span><br><span class="line">decrby key number #减number</span><br><span class="line">getrange key start end #查看从start到end的字符串，从0开始如果end为-1则为全部</span><br><span class="line">setrange key start xx #从start开始将字符串替换为xx，替换的长度就是xx的长度</span><br><span class="line">setex key time value #设置值的同时设置过期时间</span><br><span class="line">setnx key xx #如果当前key不存在的时候进行创建，如果存在则创建失败，在分布式锁中使用</span><br><span class="line">mset k1 v1 k2 v2 #批量设置</span><br><span class="line">mget k1 k2 k3 #批量获取</span><br><span class="line">msetnx k1 v1 k2 v2 #k1 k2必须都不存在才设置成功，原子性操作</span><br><span class="line">getset key xx #如果不存在key则返回null否则获取之前值设置新的值</span><br></pre></td></tr></table></figure></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">高明</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://skysea-gaoming.github.io/2020/02/29/Redis/">https://skysea-gaoming.github.io/2020/02/29/Redis/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/02/29/Git/"><i class="fa fa-chevron-left">  </i><span>Git</span></a></div><div class="next-post pull-right"><a href="/2020/02/29/ComputerNetwork/"><span>ComputerNetwork</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="disqus_thread"></div><script>var unused = null;
var disqus_config = function () {
  this.page.url = 'https://skysea-gaoming.github.io/2020/02/29/Redis/';
  this.page.identifier = '2020/02/29/Redis/';
  this.page.title = 'Redis';
}
var d = document, s = d.createElement('script');
s.src = "https://" + '你的disqus的 short-name' +".disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script><script id="dsq-count-scr" src="https://你的disqus的 short-name.disqus.com/count.js" async></script></div></div><footer class="footer-bg" style="background-image: url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1605784321698&amp;di=835f40a2b6d3b20d5d4c32b6ae74423d&amp;imgtype=0&amp;src=http%3A%2F%2Ft9.baidu.com%2Fit%2Fu%3D390739009%2C2408580797%26fm%3D193)"><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By 高明</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" data-click="false"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>